Open File shell for TC, версия 1.8c (1.8.5.31)

-----------------------------------------------------------------------

		     ВНИМАНИЕ

	 Данная версия является БЕТА ВЕРСИЕЙ!
        Она может быть нестабильной и неудобной
      в работе. Если для вас главное - надёжность
       и предсказуемость, пользуйтесь проверенными
                  релизами программы!
           Последний стабильный релиз - 1.8b

http://www.antoon-inc.com/download/oftc/util_openfiletc_v1.8b.rar

-----------------------------------------------------------------------

Эта программа позволяет открывать файлы из-под Total Commander по F4 в нужном
пользователю редакторе. Программа имеет приятный интуитивно понятный Windows-интерфейс
и небольшой файл справки, помогающий быстро освоить работу с программой.

Для установки программы необходимо сделать следующее:
 - распакуйте архив (целиком) в нужную для вас папку
 - запустите OpenFileTC.exe. Программа при первом запуске автоматически
   зарегистрирует себя в качестве редактора для Total Commander

Для работы с установленной программой необходимо сделать следующее:
 - запустить Total Commander
 - нажать на файле, который требуется редактировать, на клавишу F4.
 - в появившемся окне выбрать нужный редактор, или выбрать пункт "Другая программа"
   и в окне выбора найти нужный редактор.

Программа бесплатная. На надёжность тестировалась под ОС WinXP и Win98

Copyright © Antoon_Inc company, 2004-2008. All Rights Reserved.
Связь с разработчиком: oftc@antoon-inc.com, ICQ 207-298-917

История программы:

Версия 1.8c BETA (15 апреля 2008 г.) (добавление красивостей)
  Добавлено.  Добавлена возможность задать прозрачность для главного окна и для всех
              вспомогательных окон
  Добавлено.  Добавлена возможность убрать задний фон для главного окна (сделать его 
              полностью прозрачным)
  Добавлено.  Если вручную внести параметр "UseInactivePanel=1" для какого-нибудь редактора, 
              то данный редактор при редактировании будет брать список выделенных файлов
	      из активной и неактивной панели сразу.
  Добавлено.  Если вручную внести параметр "SendOnlyThisFilesCount=N" (N - число больше 
              нуля) для какого-нибудь редактора, то данный редактор будет редактировать
	      файлы поддерживаемых расширений только в том случае, если в Total Commander 
	      выбрано ровно N файлов.
  Исправлено. Исправление замеченных неточностей.

Версия 1.8b (11 марта 2008 г.) (исправление давно назревших проблем)
  Добавлено.  В ком. строку добавлен новый параметр "/force" - принудительный запуск OFTC
  Добавлено.  В настройках добавлена галочка "Показать панель с кнопками"
  Добавлено.  Новый пункт в выпадающем меню - Добавить расширение 
              в список поддерживаемых / Удалить расширение из списка поддерживаемых
  Добавлено.  Если вручную внести в OpenFileTC.ini параметр OpenAtOnceForAnyExt=1 для 
              какого-то редактора, то строки вида "ext_OpenAtOnce=1" для этого редактора 
	      можно удалить: по умолчанию все расширения будут сразу открываться в данном 
	      редакторе.
  Исправлено. Значительные изменения в процедурах сохранения и загрузки ini-файла: количество
              операций чтения и записи сокращено примерно в 2 раза.
  Исправлено. Общая командная строка для всех расширений отрабатывает корректно
  Исправлено. Была ошибка с открытием файлов, в чьих именах присутствовали 
              Unicode-символы (к примеру, из японского или китайского языков) - в этом
	      случае OFTC запускалась в режиме настройки вместо открытия этих файлов
  Исправлено. Недочёт при F4 на exe-файле - OFTC при повторном редактировании того же 
              исполняемого файле заново спрашивал, добавить или нет этот редактор. 
	      Теперь после добавления не спрашивает.
  Исправлено. Исправлен недочёт с изменением размеров окна для редактирования расширений
  Исправлено. Программа не распознавала первый файл, если он содержал пробелы в пути
              и передавался без кавычек в ком. строке (проблема с TC Plugin Manager)
  Исправлено. Немного изменился вид окна для выбора языка при первом старте
  Исправлено. Плохая работа программы со своей командной строкой - было практически 
              невозможно запустить программу на другом ini-файле. Параметр /I= не 
	      отрабатывал должным образом.
  Исправлено. Решена проблема с программой FTPDrive - раньше при нажатии F4 на файле,
              размер файла отображался как ноль, и редакторы не хотели его открывать 
	      - писали, что файл отсутствует. Физически размер файла не менялся.
  Исправлено. Если принудительно вызывалась программа, которая данное расширение 
              открывала сразу, то галочка "Всегда использовать..." была сброшена
  Исправлено. Небольшие изменения в выпадающем меню
  Исправлено. Если при выборе, после нажатия кнопки мыши отвести курсор в сторону, 
              не отпуская при этом кнопку, то после закрытия редактора OFTC выдавал 
	      Runtime error
  Исправлено. Небольшие исправления при самом первом запуске программы. Теперь иконки 
              у программ показываются. Также, "Блокнот" называется по-русски :)

Версия 1.8a  (01 ноября 2007 г.) (ускорение работы программы, добавление 
функциональности)
  Добавлено:  теперь программа поддерживает переменные окружения %U3_APP_DATA_PATH%, 
              %U3_DEVICE_EXEC_PATH%, %U3_HOST_EXEC_PATH%
  Добавлено:  в языковой файл добавлена опция 
             [Misc] 
	       5=[здесь ссылка на обсужение OpenFileTC на языке переводчика]
  Добавлено:  появился тулбар с кнопками
  Добавлено:  (ВАЖНО!!!) теперь программа умеет редактировать файлы из результатов 
  поиска и 
              файлы при отображении в режиме Ctrl+B
  Добавлено:  теперь можно принудительно вызывать программу удерживанием клавиши 
  Escape
  Добавлено:  если есть редактор по умолчанию, и если он является предпочтительным, 
  то при 
              открытии окна OpenFileTC будет выделяться именно этот редактор
  Добавлено:  за счёт внуреннего изменения кода, значительно ускорилась работа 
  программы. 
              Настоятельно рекомендую давно пользующимся людям обновить версию
  Исправлено: после перезапуска все удалённые в списке программы снова появлялись
  Исправлено: не всегда отрабатывала опция DisableCallsCount: если программа 
  запускалась на 
              расширении сразу, то подсчёт числа запусков всё равно вёлся, даже с 
	      DisableCallsCount=1
  Исправлено: при смене имени приложения, не менялось имя этой программы в главном 
  окне
  Исправлено: если для открываемого расширения был назначен редактор, который сразу
              должен открывать данный файл, то при принудительном вызове OpenFileTC
	      на данном расширении эта опция обнулялась
  Исправлено: при открытии файлов сразу же в редакторе (без открытия окна OFTC) могла 
              вылетать критическая ошибка записи в ini-файл
  Исправлено: не отрабатывала команда /L=%L

Версия 1.7c  (15 июля 2007 г.) (исправление ошибок, добавление возможностей)
  Добавлено:  теперь есть возможность назначить редактор по умолчанию. Он будет 
  открывать 
              все новые файлы без открытия окна OpenFileTC. Удобно, если приходится 
	      много 
	      работать с текстовыми файлами, имеющими различные расширения
  Добавлено:  опция на отключение/включение добавления редакторов при F4 на 
              исполняемом файле
  Исправлено: при вызове программы по горячей клавише, расширение не добавлялось к 
              списку поддерживаемых расширений данной программы
  Добавлено:  скрытая опция [Main] DisableCallsCount=1 - отключение подсчёта вызовов
  Добавлено:  флаги для открытия: максимализация / миним. / норм
  Добавлено:  F4 на exe-файлах - предлагать добавлять программу в список редакторов
  Добавлено:  английский язык стал встроенным языком
  Исправлено: "Потерянные программы" - если указывался правильный путь для потерянной 
              программы, то программа не исчезала из "Потерянных программ" и её 
	      иконка 
	      не менялась
  Исправлено: некорректное поведение программы с галочкой "Всегда открывать данное 
              расширение..." - программа не всегда "слушалась" :)
  Исправлено: при передаче OpenFileTC через /I= пути до ini-файла, программа не 
  цепляла 
              список выделенных файлов
  Добавлено:  возможность указать общую командную строку для всех расширений сразу 
              (пока сделано кривовато, будет потом поправлено)
  Добавлено:  программа считывает переменную окружения PATH
  Добавлено:  программы Notepad, Wordpad, MSPaint добавляются при первом старте 
  программы
  Исправлено: не всегда программа правильно работала со строками, в которых 
  присутствовали 
              переменные окружения
  Исправлено: при выборе языка (первый старт) не анализировалась позиция мыши при 
  щелчке. 
              Вследствие этого был возможен выбор не того языка
  Исправлено: большое количество мелких исправлений в окне для редактирования 
  расширений
  Добавлено:  поддержка %1 (по значению совпадает с указанием %FullFileName%)
  Добавлено:  кнопка "Горячая клавиша" в окне настроек программы
  Исправлено: нельзя было удалить горячую клавишу, только заменить новой
  Добавлено:  реализована поддержка замены разделителя между расширениями в ini-файле 
              программы. 
  Добавлено:  реализована поддержка указания разделителя в языковых файлах (при смене
              языка меняются все разделители)
  Добавлено:  программа запоминает свои размеры в режиме настроек и в режиме открытия 
  файла
              раздельно друг от друга
  Добавлено:  при принудительном вызове выделяется та программа, которая должна была 
  открыть 
              этот файл без показа OpenFileTC
  Добавлено:  теперь можно указать, в каком положении будет галочка "Всегда 
  использовать 
              выбранную программу..." при перезапуске OFTC - включена, выключена или 
	      по 
	      последнему состоянию
  Исправлено: в подсказке к программам теперь список поддерживаемых расширений 
  умещается на 
              нескольких строчках, раньше было всё на одной

Версия 1.7b  (21 января 2007 г.) (заточка программы под Total Commander v7.0)
 1) Для версии Total Commander v7.0 и выше: программа получает список файлов 
    без использования буфера обмена. ВНИМАНИЕ: эта опция гарантированно работает 
    только при кратком и подробном отображении списка файлов у TC. В частности,
    при режиме Просмотр эскизов, OpenFileTC не отрабатывает.
    Для версии Total Commander v6.5x и младше: работа с буфером обмена немного
    улучшена, уменьшился шанс потери буфера обмена. Настоятельно рекомендуется 
    перейти на TC версии 7.0!
 2) При простом запуске OpenFileTC переходит в режим настройки: нет элемента
    "Другая программа", нет галочки "Всегда использовать...". При выборе элемента 
    открывается окно настроек этой программы
 3) Поддержка запуска на другом Ini-файле, в пути до ini-файла поддерживаются 
    те переменные окружения, которые программа умеет обрабатывать 
    (Список поддерживаемых тэгов - см файл "SupportedTags_rus.txt")
    Командная строка: /I="<путь до ini-файла>"
 4) Программа поддерживает следующие тэги:
      %RootDrive% - буква диска с двоеточием, с которого запускается OpenFileTC("C:", 
      "D:")
      %COMMANDER_DRIVE% - буква диска с двоеточием, с которого запускается Total 
      Commander
 5) Теперь программа корректно обрабатывает пути, содержащие строки с "..\" (на 1 
 уровень
    вверх).
 6) Принудительный запуск программы теперь можно задать через один из трёх 
 переключателей
    (Caps Lock, Num Lock, Scroll Lock) и/или через позицию мыши на экране (один из 
    четырёх 
    углов экрана)
 7) Настройки отдельных программ - теперь можно задать иконку для отображения 
 программы 
    в OpenFileTC
 8) Исправлено: если программа по умолчанию была удалена, то OpenFileTC никак 
    не реагировала на нажатие F4 на этом файле. Теперь открывается главное окно 
    OpenFileTC
 9) Исправлено: для файлов с пустым расширением не всегда хотел выставлять опцию 
 "Всегда 
    открывать в выбранном редакторе" 
10) Теперь программа получает полное имя Ini-файла Total Commander через переменную
    окружения %COMMANDER_INI%
11) Исправлено: при добавлении новой программы с некорректным exe-файлом 
(нестандартный
    заголовок с описанием программы) программа выдавала ошибку Invalid Pointer 
    Operation. 
12) Большое количество мелких исправлений: улучшен вид программы при различных 
расширениях 
    экрана, окна запоминают свои размеры, настройки сохраняются и загружаются 
    корректно.

Версия 1.7а  (15 августа 2006 г.) (небольшие улучшения, повышение удобства)
 1) Теперь запуск программ по F4 происходит значительно быстрее в случае, если 
    стоит галочка "Всегда использовать...". Сделано это за счёт значительной 
    оптимизации кода, выполняемого при старте
 2) Иконки теперь грузятся в отдельном потоке, потому скорость запуска программы
    слабо зависит от загрузки иконок для приложений.
 3) Появилась опция "Включить всплывающие подсказки"
 4) Шрифты для главного окна и остальных окон настраиваются отдельно
 5) Появилась возможность сортировать по частоте вызова. Также ведётся 
    статистика частоты вызова всех программ
 6) Теперь программа не перезагружается при изменении своих настроек.
 7) Дополнительные пункты в выпадающем меню, для быстрой смены вида программы.

Версия 1.6  (17 июля 2006 г.) (исправление ошибок)
 1) Поправлено: теперь сложная командная строка корректно отправляется 
    выбранному приложению.
 2) Поправлено: файл из архива теперь открывается из временной папки.
 3) Терялся тип запуска для отдельного приложения при изменении списка 
    поддерживаемых расширений.
 4) Поправлено: горячая клавиша назначается корректно
 5) Сделано несколько вариантов интерфейса: значки, мал. значки, список, 
    таблица. Во всех четырёх видах видны иконки
 6) Поправлено: в настройках приложения нельзя было открыть диалоговое окно 
    "Открыть файл" при нажатии на кнопку "...".
 7) Поправлены все замеченные ошибки с работой относительных путей.
 8) Появились две новые полезные настройки Open File TC
 9) Теперь если выделено несколько файлов, то открываться будут только они. 
    Файл под курсором (если он не выделен) открываться не будет
10) В выпадающем меню появилось два новых пункта - Открыть в <Имя приложения> и 
    Открыть, но не следить за приложением
11) Другие малозаметные изменения и улучшения

Версия 1.5  (8 мая 2006 г.) (перевод на Unicode-строки)
 1) Программа переведена на Unicode. Теперь программа корректно отбражает все языки,
    которые поддерживают Unicode. Внимание: языковые файлы прошлых версий могут
    некоректно отображаться в программе, рекомендуется как можно быстрее загрузить 
    языковые файлы Вашей страны для версии 1.5, или вручную сконвертировать lng-файлы 
    в
    Unicode.
 2) Исправлено: программа некорректно работала с файлами, у которых расширение было в 
    верхнем регистре.
 3) Добавлено: теперь каждой программе можно назначить свою горячую клавишу. 
 Следующие 
    клавиши зарезервированы самой программой: 0..9, Enter, Esc
 4) Исправлено: ошибка при работе с файлами, у которых не было расширения. Для того, 
 чтобы
    редактор попал в число предпочтительных при открытии файлов без расширения, нужно 
    добавить
    для этой программы расширение %nil% в число поддерживаемых.
 5) Исправлена ошибка с буфером обмена. Теперь программа оставляет буфер обмена 
 пользователя 
    без изменений.
 6) К выпадающему меню добавился пунки Настроить <Имя программы>. С помощью этого 
 пункта
    можно указать способ запуска программы.
 7) Другие изменения и улучшения.

Версия 1.4. (23 февраля 2006 г.) (косметические изменения)
 1) Появилась поддержка следующих относительных путей:
    %COMMANDER_PATH%    - полный путь до папки с запущенным TotalCommander
    %WinDir%            - папка Windows
    %ProgramFiles%      - папка Program Files
    %OpenFileTC_Path%   - папка с запущенной OpenFileTC
    Их можно заносить в пути к программам. Параметры замещаются БЕЗ слэша на конце.
    ВНИМАНИЕ: параметр %COMMANDER_PATH% работает только в том случае, если OpenFileTC
    была запущена непосредственно из-под Total Commander. В противном случае 
    программа
    будет работать некорректно с такими путями
 2) Исправлены ошибки, связанные с некорректной работой с Ini-файлом. Раньше в
    поддерживаемых расширениях могли присутствовать повторы. Также программа могла 
    запустить не то приложение, которое ожидалось
 3) Окно редактирования ассоциаций: расширения сортируются по имени
 4) Исправлена некрасивость с подсказкой для программ: теперь подсказка всегда
    показывается (иногда она отказывалась показываться)
 5) Теперь программа нормально отображает 32-битные иконки. Также программа больше
    не создаёт bmp-файлы в Icons-папке.
 6) Поддерживаемые расширения в ini-файле теперь можно разделять запятыми, 
    например, так: "SupportedExts=pas, bat, txt"
 7) Теперь многопользовательность - опциональная функция, выключена по умолчанию.
 8) Другие малозаметные исправления, улучшения и добавления.

Версия 1.3. (06 февраля 2006 г.) (усиление программы)
1) Теперь предпочтительные программы можно выбрать нажатием на цифры 1..9.
   То есть, при нажатии на 1 откроется первая по списку программа, на 2 - вторая, 
   и т.д. Также можно выбрать программу, выделив её и нажав Enter. По умолчанию 
   выбрана самая первая программа в списке.
2) Теперь для каждого пользователя программа использует свои Ini-файлы.
3) Для принудительного открытия программы достаточно включить кнопку Scroll Lock
4) Раздел "Настройки Open file shell for TC" исчезли, их заменил пункт 
   "Настроить программу" в выпадающем меню программы.
5) Пункт "Найти EXE" исчез как ненужный (если считаете, что пункт стоило оставить, то 
 !)
6) Программа корректно определяет путь до файла настроек TC. Большая благодарность за 
это 
   mozers™ & Shura и Владимиру Сердюку, чьи исходные коды были использованы в 
   программе.
7) Теперь можно отправлять сразу несколько файлов на редактирование. Пока что 
механизм 
   работы следующий: все файлы разом отправляются одному редактору, независимо от 
   расширения. 
   Редактор определяется по выделенному курсором файлу. В будущих версиях появится 
   возможность 
   отправлять каждый файл на редактирование отдельно.
8) Исправлено: теперь после редактирования файла внутри архива TC предложит 
перепаковать архив.   

Версия 1.2. (15 октября 2005 г.) (добавление возможностей по настройке программы)
1) Появился пункт-переключатель "Показать иконки / Скрыть иконки", он позволяет
   ускорить загрузку программы за счёт понижения "красивости": при открытии программы
   не будут загружаться иконки программ.
2) Появился пункт-переключатель "В виде списка / В виде иконок", он позволяет
   показывать все элементы программы или в виде больших иконок, или в виде списка.
   Стиль "в виде списка" автоматически отключает загрузку иконок, поэтому в таком
   стиле программа будет грузиться быстрее.
3) Появилась возможность удалять элементы из раздела "Настройки": при нажатии
   по элементу на правую клавишу мыши появляется выпадающее меню.

Версия 1.1. (05 октября 2005 г.) (исправление замеченных ошибок, повышение 
стабильности и гибкости 
программы)
1) Поправлено большое количество ошибок, связанных с возможным запуском
   программы с места "только для чтения". Теперь программу можно запускать 
   с компакт-диска, в этом случае она прописывает свой файл настроек 
   в системную папку (Windows - папку).
2) Появилась сортировка программ по названию программы.
3) Исправлены замеченные опечатки в файле справки. Добавлено описание
   пунктов выпадающего меню.
4) Добавлена возможность задания особой командной строки для каждого 
   расширения у каждой программы. Подробнее о тэгах написано 
   в разделе "командная строка"
5) Другие исправления замеченных ошибок

Версия 1.0. (02 октября 2005 г.) (первый выход программы)
"Зарождение" программы, её выход "в свет" :)
